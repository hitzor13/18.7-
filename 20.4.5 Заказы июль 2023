import json
from collections import Counter
with open("orders_july_2023.json.json", "r") as my_file:
    orders = json.load(my_file)

# 1. Какой номер самого дорогого заказа за июль?
max_price = 0
max_order = ''

# 2. Какой номер заказа с самым большим количеством товаров?
max_quantity = 0
max_order_quantity = ''

# Для других задач:
orders_per_day = Counter()
orders_per_user = Counter()
sum_price_per_user = Counter()
total_price = 0
total_quantity = 0
num_orders = 0

for order_num, orders_data in orders.items():
    price = orders_data["price"]
    quantity = orders_data["quantity"]
    date = orders_data["date"]
    user_id = orders_data["user_id"]

    # Самый дорогой заказ в Июле
    if price > max_price:
        max_price = price
        max_order = order_num

    # Заказ с самым большим количеством товаров
    if quantity > max_quantity:
        max_quantity = quantity
        max_order_quantity = order_num

    # Статистика для других вопросов
    orders_per_day[date] += 1
    orders_per_user[user_id] += 1
    sum_price_per_user[user_id] += price
    total_price += price
    total_quantity += quantity
    num_orders += 1

# 3. В какой день в июле было сделано больше всего заказов?
most_orders_day = orders_per_day.most_common(1)[0]

# 4. Какой пользователь сделал самое большое количество заказов за июль?
most_orders_user = orders_per_user.most_common(1)[0]

# 5. У какого пользователя самая большая суммарная стоимость заказов за июль?
most_expensive_user = sum_price_per_user.most_common(1)[0]

# 6. Средняя стоимость заказа
avg_order_price = total_price / num_orders

# 7. Средняя стоимость товаров
avg_item_price = total_price / total_quantity

print(f"1. Номер заказа с самой большой стоимостью: {max_order}, стоимость заказа: {max_price}")
print(f"2. Номер заказа с наибольшим количеством товаров: {max_order_quantity}, товаров: {max_quantity}")
print(f"3. День с наибольшим количеством заказов: {most_orders_day[0]}, количество заказов: {most_orders_day[1]}")
print(f"4. Пользователь с наибольшим количеством заказов: {most_orders_user[0]}, количество заказов: {most_orders_user[1]}")
print(f"5. Пользователь с наибольшей суммарной стоимостью заказов: {most_expensive_user[0]}, сумма: {most_expensive_user[1]}")
print(f"6. Средняя стоимость заказа: {avg_order_price:.2f}")
print(f"7. Средняя стоимость товаров: {avg_item_price:.2f}")
